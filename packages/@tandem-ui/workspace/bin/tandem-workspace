#!/usr/bin/env node
const yargs = require("yargs");
const { start } = require("../lib/server.js");
const execa = require("execa");

yargs.command(
  "start [project]",
  `start workspace`,
  (yargs) => {
    return yargs
      .option("port", {
        // default: 8080,
      })
      .option("open")
      .option("autoSave")
      .option("branch");
  },
  ({ project, port, open, autoSave, branch }) => {
    start({
      cwd: process.cwd(),
      autoSave,
      project,
      branch,
      http: {
        port: port,
      },
    }).then((server) => {
      if (open) {
        execa(`open`, [`http://localhost:${server.getPort()}`]);
      }
    });
  }
).argv;
